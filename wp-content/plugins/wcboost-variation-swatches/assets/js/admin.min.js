jQuery(function(c){"use strict";var i=null;var t={init:function(){c(".wcboost-variation-swatches__field-color input").wpColorPicker();c(document.body).on("click",".wcboost-variation-swatches__field-image .button-add-image, .wcboost-variation-swatches__field-image img",this.uploadImage).on("click",".wcboost-variation-swatches__field-image .button-remove-image",this.removeImage);c("#wcboost_variation_swatches_data").on("change",".wcboost-variaton-swatches__type-field select",this.toggleSwatchesMetabox).on("change",".wcboost-variaton-swatches__size-field select",this.toggleCustomSizeFields);c("#variable_product_options").on("reload",this.reloadSwatchesPanel);c("#product_attributes").on("click","button.add_new_attribute_with_swatches",this.openNewAttributeDialog);c("#wcboost-variation-swatches-new-term-dialog").on("input",'input[name="attribute_name"]',this.validateDialogInputs).on("click","button.media-modal-close, .media-modal-backdrop",this.closeDialog).on("click","button.button-add",this.ajaxAddTerm)},uploadImage:function(t){t.preventDefault();var a=c(this);if(i){i.off("select")}else{i=wp.media({title:a.attr("aria-label"),button:{text:a.data("choose")},multiple:false})}i.on("select",function(){var t=i.state().get("selection").first().toJSON();a.closest(".wcboost-variation-swatches__field-image").find('input[type="hidden"]').val(t.id);a.siblings(".button-remove-image").removeClass("hidden");var e=t.sizes&&t.sizes.thumbnail?t.sizes.thumbnail.url:t.url;a.closest(".wcboost-variation-swatches__field-image").find("img").attr("src",e)});i.open()},removeImage:function(t){t.preventDefault();var e=c(this);e.addClass("hidden");e.closest(".wcboost-variation-swatches__field-image").find('input[type="hidden"]').val("");e.closest(".wcboost-variation-swatches__field-image").find("img").attr("src",function(){return this.dataset.placeholder})},toggleSwatchesMetabox:function(){if(this.value&&this.value!=="select"&&this.value!=="button"){c(this).closest(".options_group").siblings(".options_group--swatches").find(".form-field__swatches-"+this.value).show().siblings().hide()}else{c(this).closest(".options_group").siblings(".options_group--swatches").children().hide()}},toggleCustomSizeFields:function(){if(this.value==="custom"){c(this).closest(".form-field").next(".form-field--custom-size").show()}else{c(this).closest(".form-field").next(".form-field--custom-size").hide()}},reloadSwatchesPanel:function(){var t=window.location.toString();t=t.replace("post-new.php?","post.php?post="+woocommerce_admin_meta_boxes.post_id+"&action=edit&");c("#wcboost_variation_swatches_data").load(t+" #wcboost_variation_swatches_data_inner",function(){setTimeout(function(){c(".wcboost-variation-swatches__field-color input").wpColorPicker()})})},closeDialog:function(t){t.preventDefault();c("#wcboost-variation-swatches-new-term-dialog").hide()},openNewAttributeDialog:function(t){t.preventDefault();var e=c(this),a=c("#wcboost-variation-swatches-new-term-dialog"),i={type:e.data("type"),taxonomy:e.closest(".woocommerce_attribute.wc-metabox").data("taxonomy")};c('input[name="attribute_taxonomy"]',a).val(i.taxonomy);c('input[name="attribute_type"]',a).val(i.type);c(".form-field__swatches",a).children().hide().filter(".wcboost-variation-swatches__field-"+i.type).show();a.show()},validateDialogInputs:function(){if(!this.value){this.classList.add("error")}else{this.classList.remove("error")}},ajaxAddTerm:function(t){t.preventDefault();var a=c(this),i=c("#wcboost-variation-swatches-new-term-dialog"),o=c(".spinner",i),s=c(".wcboost-variation-swatches-modal__message",i),n=c(":input",i).serializeObject();console.log(n);if(!n.attribute_name){c('input[name="attribute_name"]',i).focus();return}o.addClass("is-active");s.hide();a.prop("disabled",true);wp.ajax.send("wcboost_variation_swatches_add_term",{data:n,error:function(t){o.removeClass("is-active");s.addClass("error").text(t).show();a.prop("disabled",false)},success:function(t){o.removeClass("is-active");s.addClass("success").text(t.message).show();a.prop("disabled",false);c('input[name="attribute_name"]',i).val("").removeClass("error");c('input[name="label"]',i).val("");c(".wp-picker-clear",i).trigger("click");c(".button-remove-image",i).trigger("click");var e=c('.woocommerce_attribute.wc-metabox[data-taxonomy="'+n.attribute_taxonomy+'"]',"#product_attributes");c("select.attribute_values",e).append('<option value="'+t.term_id+'" selected="selected">'+n.attribute_name+"</option>").change()}})}};t.init()});